## 二、本周详细工作计划（第 1 周）

本周目标再强调一遍：

> **交付前端设计图 + 数据库架构 + 接口设计文档 + 项目骨架可运行。**

下面按人 + 时间段拆。

------

### 你（负责人 / 架构）

**前半周（周一～周三）**

1. **数据库设计**
   - 和王成友、于凯程一起开个短会（线上/线下都行），拉一个粗 ER 图：
     - `users`、`logs`、`alerts`、`operation_log`、`system_config`
   - 输出：
     - `docs/db-schema.md`：每张表的字段说明、索引说明。
     - `sql/init_schema.sql`：建表 SQL 初稿。
2. **后端骨架**
   - 搭 FastAPI 基础：`main.py`、`api/v1/api.py`。
   - 完成 `db/session.py`（连接 MySQL）+ `db/base.py`。
   - 写一个测试接口 `/api/v1/ping`，确认前后联通。

**后半周（周四～周日）**

1. **认证 & 安全框架雏形**
   - 在 `core/security.py` 写密码哈希 + 简单 JWT 生成/验证函数（先写死 secret 也行，后面挪到配置）。
   - 在 `core/deps.py` 写 `get_db`、`get_current_user` 雏形（先用假用户也可以）。
2. **接口设计文档**
   - 和所有人对齐后，输出 `docs/api-docs.md`：
     - 写清本周要确定的接口：
       - `/auth/login`, `/auth/me`
       - `/logs` 系列
       - `/alerts` 系列
       - `/stats` 系列
       - `/operation-logs`
     - 对每个接口写：Method、Path、Query/body 参数、示例响应。
3. **项目规范**
   - 在 README 或单独文档约定：
     - 分支命名（比如 `feature/logs-api`）、
     - 提交信息格式、
     - 后端/前端代码风格简单约定（比如黑/ruff/ESLint 是否用，实在没时间就只约定基本命名规则）。

------

### 王成友（B，日志采集）

**前半周**

1. **参与 DB 设计（重点 logs）**
   - 和你一起确认 `logs` 表字段：`source/level/timestamp/ip/user_name/message/raw_data/parsed_ok` 等。
   - 提出满足查询需求的索引（时间、level、source、ip）。
2. **模型草稿**
   - 根据最终表结构写：`models/log.py`。
   - 写对应 `schemas/log.py`：
     - `LogCreate`、`LogRead`、`LogQueryParams` 等。

**后半周**

1. **接口参数设计**
   - 草拟 `GET /logs` 所需 query 参数：
     - 时间范围、级别（多选）、来源、IP、关键字、分页。
   - 草拟 `POST /logs/upload-file` 的 form-data 参数（source、file 等）。
   - 把这些字段写入 `api-docs.md` 对应章节。
2. **准备测试日志样本**
   - 造一两个简化的日志文件示例（web / firewall），放到 `samples/` 目录后面开发用。

------

### 于凯程（C，告警 & 统计 & 审计）

**前半周**

1. **表结构设计**
   - 设计 `alerts`、`operation_log`、`system_config` 三张表字段。
   - 考虑查询维度：time、type、status、user_id 等索引。
   - 在 `docs/db-schema.md` 中写明字段解释。
2. **告警规则文档**
   - 写 `docs/alert-rules.md`：
     - 暴力破解规则：时间窗口、失败次数阈值、触发字段（IP / 用户名）。
     - ERROR 日志规则：哪些 level 会触发什么级别告警。
     - 后续可以扩展的规则（先列个 TODO）。

**后半周**

1. **统计接口设计**
   - 在 `api-docs.md` 中设计：
     - `/stats/logs-by-time`：入参：时间范围、粒度（小时/天）；出参数组格式。
     - `/stats/logs-by-level`：出参 level→count。
   - 设计 `/alerts` 列表 / 详情 / 修改状态 的请求参数和响应体结构。
2. **操作日志接口设计**
   - 确定 `operation_log` 会记录哪些 action（LOGIN、UPLOAD_LOG、CHANGE_ALERT_STATUS 等）。
   - 设计 `/operation-logs` 的查询参数（时间范围、用户、action）和返回字段。

------

### 吴昊（D，前端框架 & 日志页）

**前半周**

1. **前端项目骨架**
   - 使用 Vue3 + Vite 创建项目（或老师要求的框架）。
   - 搭 `src/router/index.ts`，配置基础路由：`/login`、`/dashboard`、`/logs`、`/alerts`、`/operation-logs`、`/system-config`。
   - 创建 `views/Login.vue`、`Layout.vue`、空的几个页面组件文件。
2. **axios 封装**
   - 创建 `src/api/http.ts`：
     - 设置 baseURL（指向 FastAPI）。
     - 请求拦截器自动带 token（先从 localStorage 取）。
     - 响应拦截器简单处理错误（console 或 message 提示）。

**后半周**

1. **信息架构 & 组件规划**
   - 和王建普一起确定菜单结构、页面间的跳转关系。
   - 写一份 `docs/frontend-structure.md`：
     - 列出每个页面负责显示哪些数据，依赖哪些 API。
     - 列出计划拆分的组件，比如：`LogFilterForm`、`LogTable`、`AlertTable`、`LogTrendChart` 等。
2. **初步页面骨架**
   - 在 `Layout.vue` 中实现基本布局（顶部导航、侧边菜单、内容区域）。
   - 在 `Logs.vue` 中写简单布局占位符，方便后面快速填数据。

------

### 王建普（E，Dashboard & 告警 & 审计前端设计）

**本周重点：设计图直接决定后面所有前端工作，优先级最高。**

**前半周**

1. **页面草图 / 线框图**
   - 先出低保真草图（纸上画也行），再整理到工具里：
     - 登录页：输入框、错误提示、登录按钮、忘记密码可以先不做。
     - Dashboard：上面统计卡片（总日志数、告警数）、下面图表区域。
     - Logs：筛选区 + 表格区 + 操作按钮区（上传、导出）。
     - Alerts：筛选 + 表格 + 状态标签 + 操作按钮（修改状态）。
     - OperationLogs：表格为主。
2. **与后端字段对齐**
   - 根据 DB & API 文档，确定每个表格列名、字段映射。
   - 在设计稿旁标注字段名（比如：IP、Level、Source、Timestamp、Message）。

**后半周**

1. **高一点保真的设计稿**
   - 在 Figma / 墨刀 / 其它工具里画出稍微规范一点的 UI：
     - 统一色系（例如蓝 + 灰），统一按钮样式。
     - 表格样式统一（表头、奇偶行、hover，先定大致风格）。
   - 输出方式：
     - 导出为图片 + 链接，放到 `docs/ui-design.md` 中说明。
2. **交接给前端实现**
   - 和吴昊一起走查：
     - 每个页面的组件拆分是否合理。
     - 有没有需要后端多给字段的地方（比如 Dashboard 卡片统计数字）。

------

## 小结

- 三周总计划：
  - 本周：**架构 & 设计**（UI 图 + DB + API）
  - 下周：**核心功能开发**（后端接口 + 主要前端页面联调）
  - 第三周：**联调、优化、文档 & 演示**
- 本周你们要做到：
  - 有清晰的 **数据库表结构文档 + 建表 SQL**；
  - 有清晰的 **接口文档**；
  - 有成型的 **前端设计图**；
  - FastAPI 和 Vue 项目都能跑起来，后续开发只是在骨架上填肉。